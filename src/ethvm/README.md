# VM
Implementation of EVM in rust.

## Introduction
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract Dice {
    uint256 public a;
    mapping(uint256 => uint256) store;

    function save(uint256 _a, uint256 _n) external {
        store[_a] = _n;           
    }
}
```
Compiled byte code:
```
608060405234801561001057600080fd5b50604051610272 3803806102728339818101604052810190610032919061005c565b816000819055508060018190555050506100c2565b600081519050610056816100ab565b92915050565b60008060408385031215610073576100726100a6565b5b600061008185828601610047565b925050602061009285828601610047565b9150509250929050565b6000819050919050565b600080fd5b6100b48161009c565b81146100bf57600080fd5b50565b6101a1806100d16000396000f3fe608060405234801561001057600080fd5b50600436106100415760003560e01c80630dbe671f146100465780634df7e3d01461006457806357fc036314610082575b600080fd5b61004e61009e565b60405161005b919061012a565b60405180910390f35b61006c6100a4565b604051610079919061012a565b60405180910390f35b61009c600480360381019061009791906100db565b6100aa565b005b60005481565b60015481565b8060026000848152602001908152602001600020819055505050565b6000813590506100d581610154565b92915050565b600080604083850312156100f2576100f161014f565b5b6000610100858286016100c6565b9250506020610111858286016100c6565b9150509250929050565b61012481610145565b82525050565b600060208201905061013f600083018461011b565b92915050565b6000819050919050565b600080fd5b61015d81610145565b811461016857600080fd5b5056fea26469706673582212202aeef7b3454ab3a79421d54b8c833c31518909725488580f141576f70d9848da64736f6c63430008070033			
```
Disassembled code analysis:
```
Assume msg.value is not 0.

000 PUSH1 80
002 PUSH1 40
004 MSTORE
005 CALLVALUE
006 DUP1
007 ISZERO
008 PUSH2 0010
011 JUMPI
012 PUSH1 00
014 DUP1
015 REVERT
016 JUMPDEST
017 POP
018 PUSH1 40
020 MLOAD
021 PUSH2 0272

024 CODESIZE
025 SUB
026 DUP1
027 PUSH2 0272
030 DUP4
031 CODECOPY
032 DUP2
033 DUP2
034 ADD
035 PUSH1 40
037 MSTORE
038 DUP2
039 ADD
040 SWAP1
041 PUSH2 0032
044 SWAP2
045 SWAP1
046 PUSH2 005c
049 JUMP
050 JUMPDEST
051 DUP2
052 PUSH1 00
054 DUP2
055 SWAP1
056 SSTORE
057 POP
058 DUP1
059 PUSH1 01
061 DUP2
062 SWAP1
063 SSTORE
064 POP
065 POP
066 POP
067 PUSH2 00c2
070 JUMP
071 JUMPDEST
072 PUSH1 00
074 DUP2
075 MLOAD
076 SWAP1
077 POP
078 PUSH2 0056
081 DUP2
082 PUSH2 00ab
085 JUMP
086 JUMPDEST
087 SWAP3
088 SWAP2
089 POP
090 POP
091 JUMP
092 JUMPDEST
093 PUSH1 00
095 DUP1
096 PUSH1 40
098 DUP4
099 DUP6
100 SUB
101 SLT
102 ISZERO
103 PUSH2 0073
106 JUMPI
107 PUSH2 0072
110 PUSH2 00a6
113 JUMP
114 JUMPDEST
115 JUMPDEST
116 PUSH1 00
118 PUSH2 0081
121 DUP6
122 DUP3
123 DUP7
124 ADD
125 PUSH2 0047
128 JUMP
129 JUMPDEST
130 SWAP3
131 POP
132 POP
133 PUSH1 20
135 PUSH2 0092
138 DUP6
139 DUP3
...

```